{"version":3,"sources":["controllers/Search.js"],"names":["WeChat","controller","$scope","$http","$timeout","$cookies","$mdSidenav","$mdUtil","$filter","$sce","i18n","Func_Timeouter_Lock","StoreUser","AppId","ApiMapper","OpenId","window","localStorage","getItem","UrlStr","$","location","attr","RedirectUri","decodeURIComponent","split","replace","Code","getOpenId","undefined","urlstr","encodeURIComponent","PathStr","CodeId","get","newUrl","success","data","openid","wx","error","IsUItoWP","WPUIpage","CompanyId","GroupParames","Emergencys","t","TypeName","FormatLogoURI","OrderbyParames","OrderBy","name","SearhParams","MaintainerIds","EquipmentIds","FuzzyCaseCode","RezConditions","Emergency","IsInspection","UnitRegionIds","UnitDivisionIds","EquipmentTypeClass","EquipmentSubTypeId","Orders","pcompanyList","Select2List","Text","SelectedList01","SelectedList02","SelectedList03","Select2Data01","Select2Data02","Select2Data03","StoreSelectedList","MaintainerSelectedList","EquipmentSelectedList","UnitIds","StrongholdIds","Equipments","Select2Data","Select2SelectedList","tabName","RepairList","RepairInfo","RequisitionIds","AreasSelected","itemsAreaStr","CheckedIds","currentPage","isLoading","isAllSelected","isShowMore","isShowList","isShowDetail","Overtime","Search4No","RepairCounts","pcompanyName","EquipmentName","Unit","Survey","SearchTitle","SidenavList","Event","RequestTime","EndDate","Normal","DontCare","RequisitionStatus","Assignment","InStore","Acceptance","Revocation","OnConfirm","OnProcess","RawMaterialPending","EquipmentList","$watchCollection","Filing","Draft","Confirmed","push","deliberatelyTrustDangerousSnippet","snippet","Repair_Time","cancel","TimesForLock","Tag","SearchRepair","trustAsHtml","EmergencyName","url","method","cache","res","getRegions","sApi","contentType","getFacility","Passport","RegionList","headers","SubTypeSelected","getInspectionType","notifyCount","setInspectionType","item","Selected","GetStore","EquipmentSubTypeName","indexOf","splice","idx","Unitdata","StoreList","Item1","_","Item2","forEach","Id","UnitId","isSelected","Level1","UnitLevel","Item3","Level2","GetProvider","GetEquipment4Areas","length","Item","MaintainerName","MaintainerId","parseInt","Lists","JSON","EquipmentId","isShowButton","ItemId","n","Index","text","RemoveForSelect2","tabId","LoadMnti","rSetSelect2Values","SetFiterHighlight","Select2Item","nTextStr","ItemObject","ItemText","SetSelect2Values","removeClass","uniq","resetAllParams","StartDate","Yes","clearSelect2Values","closeDenav","UnitName","gotoSearch","toString","Areas","clearSelect2GroupValues","console","inspectionType","gotoGroupSearch","GetCaseCount","getNotifyList","clearSelect2Values4Item","loadSelect2Data4Item","loadSearchParams","e","href","$on","event","stringify","swipeState","Array","prototype","apply","SetCaseCode","LoadMore","ForCallback","CloseSidenav","navID","GetDetail","$broadcast","toggle","close","then","RepairItem","setItem","RequisitionId","GetEquipmentpos","IPositionIds","getHistory","filter","PositionId","GetUnitInfo","reverse","_TableData","ResponseTime","Date","DeptInfo","Base64","encode","CheckinHistories","M2H","hh","_mm","parseFloat","toFixed","SetStore","mm","GetAreas","SetMaintainer","list","Equipment","AreaStr","positionIds","Timeouter4Areas","SetAreas","SetCheckedIds","Region","Position","SetRequisitions","toggleDenav","debounceFn","debounce","FormatDate","toggleDenavFN","eventType","type","longPressSta","change_openicon","CollapseState","DivisionTempData","DivisionName","SelectSearch","selectClass","DivisionId","GetPreMonth","paramesStr","Format","CaseCountList","log","ImgUrl","ClassPage","callback2case","getParameterByName","_SelectClass"],"mappings":"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","file":"Search.js","sourcesContent":["'use strict';\r\n\r\nWeChat.controller('SearchRepairCtrl', ['$scope', '$http', '$timeout', '$cookies', '$mdSidenav', '$mdUtil', '$filter', '$sce', 'i18n', function ($scope, $http, $timeout, $cookies, $mdSidenav, $mdUtil, $filter, $sce, i18n) {\r\n  $scope.StoreUser = $cookies.StoreUser;\r\n  //取得openID\r\n  //流程是AppID(公眾號ID) > codeID(驗證碼) > openID(使用者在這個公眾號的ID) > (API) > 使用者資訊\r\n  $scope.AppId = ApiMapper.AppId;\r\n  $scope.OpenId = window.localStorage.getItem($scope.AppId);\r\n  $scope.UrlStr = $(location).attr(\"search\") || \"Unknown\";\r\n  if ($scope.UrlStr != \"Unknown\") {\r\n    $scope.RedirectUri = decodeURIComponent($scope.UrlStr.split(\"?redirect_uri=\")[1]);\r\n    $scope.RedirectUri = $scope.RedirectUri.replace(\"&\", \"?\");\r\n    $scope.Code = decodeURIComponent($scope.UrlStr.split(\"?code=\")[1]);\r\n  };\r\n  $scope.getOpenId = function () {\r\n    //如果沒有openID才去取得\r\n    if ($scope.OpenId == undefined || $scope.OpenId == null || $scope.OpenId == \"null\") {\r\n      if ($scope.Code == \"undefined\" || $scope.Code == undefined) { //判断地址是否有带Code\r\n        //這邊是微信登入取得網址 記得要把xxxxx.html改成當前的網頁\r\n        var urlstr = \"https://open.weixin.qq.com/connect/oauth2/authorize?appid=\" + $scope.AppId + \"&redirect_uri=\" + encodeURIComponent(ApiMapper.PathStr + \"search_no.html\") + \"&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect\";\r\n        location.href = urlstr;\r\n      } else {\r\n        //codeID也就是驗證碼\r\n        var CodeId = $scope.Code.split(\"&\")[0]; //從連結上面擷取code資料\r\n        var newUrl = ApiMapper.wxApi + \"/wx/r/openId?appId=\" + $scope.AppId + \"&code=\" + CodeId; //呼叫Gina API\r\n        //取得OpenID\r\n        $http.get(newUrl).success(function (data) {\r\n          //alert(\"Code:\" + CodeId + \"|openid:\" + data.openid);\r\n          $scope.OpenId = data.openid;\r\n          window.localStorage.setItem($scope.AppId, $scope.OpenId);\r\n        }).error(function (data) {\r\n          wx.closeWindow();\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  //取得openId 記得最後開微信要打開\r\n  // $scope.getOpenId();\r\n\r\n  $scope.IsUItoWP = false; // 是否王品\r\n  $scope.WPUIpage = 'selectPage'\r\n  if ($cookies.CompanyId == 'eb296708-6fc6-43f0-b506-0ca0fa91e1cd' || $cookies.CompanyId == '6c690014-2571-48db-ac5a-c6ba2572a3bb') {\r\n    $scope.IsUItoWP = true;\r\n    $scope.GroupParames = {\r\n      \"Regions\": [],\r\n      \"Emergencys\": [i18n.t(\"11074\"), i18n.t(\"11075\")],\r\n      \"TypeName\": []\r\n    };\r\n  } else {\r\n    $scope.IsUItoWP = false;\r\n    $scope.WPUIpage = 'listPage';\r\n  }\r\n  //王品区域logo去除中间分区代码\r\n  $scope.FormatLogoURI = FormatLogoURI;\r\n\r\n  $scope.OrderbyParames = [{\r\n    \"name\": \"DateM\",\r\n    \"OrderBy\": 1\r\n  }, {\r\n    \"name\": \"OverTimeInterval\",\r\n    \"OrderBy\": 0\r\n  }];\r\n  $scope.SearhParams = {\r\n    'UnitIds': [],\r\n    'MaintainerIds': [],\r\n    'EquipmentIds': [],\r\n    'FuzzyCaseCode': null,\r\n    'RezConditions': [3],\r\n    'Emergency': [0, 1, 2],\r\n    'IsInspection': 4,\r\n    'UnitRegionIds': [],\r\n    'UnitDivisionIds': [],\r\n    'EquipmentTypeClass': [0, 1],\r\n    'EquipmentSubTypeId': [],\r\n    'Orders': $scope.OrderbyParames\r\n  };\r\n  $scope.pcompanyList = [];\r\n  $scope.StoreList = [];\r\n\r\n  $scope.Select2List = [{\r\n    \"Id\": \"\",\r\n    \"Text\": \"\"\r\n  }];\r\n  $scope.SelectedList01 = [];\r\n  $scope.SelectedList02 = [];\r\n  $scope.SelectedList03 = [];\r\n  $scope.Select2Data01 = [];\r\n  $scope.Select2Data02 = [];\r\n  $scope.Select2Data03 = [];\r\n  $scope.StoreSelectedList = [];\r\n  $scope.MaintainerSelectedList = [];\r\n  $scope.EquipmentSelectedList = [];\r\n  $scope.UnitIds = [];\r\n  $scope.MaintainerIds = [];\r\n  $scope.StrongholdIds = [];\r\n  $scope.Equipments = [];\r\n  $scope.Select2Data = [];\r\n  $scope.Select2SelectedList = [];\r\n  $scope.tabName = i18n.t(\"2081\");\r\n  $scope.tabId = \"Store\";\r\n\r\n  $scope.RepairList = [];\r\n  $scope.RepairInfo = {};\r\n  $scope.RequisitionIds = [];\r\n  $scope.AreasSelected = [];\r\n  $scope.itemsAreaStr = [];\r\n  $scope.CheckedIds = [];\r\n  $scope.currentPage = 1;\r\n  $scope.isLoading = true;\r\n  $scope.isAllSelected = false;\r\n  $scope.isShowMore = false;\r\n  $scope.isShowList = false;\r\n  $scope.isShowDetail = false;\r\n  $scope.Overtime = false;\r\n  $scope.Search4No = false;\r\n  $scope.RepairCounts = 0;\r\n  $scope.pcompanyName = '';\r\n  $scope.EquipmentName = '';\r\n  $scope.Unit = i18n.t(\"1001\");\r\n  $scope.Survey = 5;\r\n  $scope.Survey1 = 5;\r\n\r\n  //左邊功能選單\r\n  $scope.SearchTitle;\r\n  $scope.SidenavList = [{\r\n    \"name\": i18n.t(\"2001\"),\r\n    \"Event\": \"Muti\"\r\n  }, {\r\n    \"name\": i18n.t(\"11128\"),\r\n    \"Event\": \"No\"\r\n  }];\r\n  // 2019/03/15 调整查询与排序UI\r\n  $scope.RequestTime = {\r\n    \"StartDate\": null,\r\n    \"EndDate\": null\r\n  };\r\n  $scope.Emergency = {\r\n    'Yes': true,\r\n    'Normal': true,\r\n    'DontCare': false\r\n  };\r\n  $scope.RequisitionStatus = {\r\n    \"Filing\": false,\r\n    \"Assignment\": true,\r\n    \"InStore\": true,\r\n    \"Acceptance\": false,\r\n    \"Revocation\": false,\r\n    \"OnConfirm\": false,\r\n    \"OnProcess\": false,\r\n    \"RawMaterialPending\": false\r\n  };\r\n\r\n  $scope.EquipmentList = [];\r\n  $scope.$watchCollection('RequisitionStatus', function () {\r\n    if (!$scope.RequisitionStatus.Filing &&\r\n      !$scope.RequisitionStatus.Assignment &&\r\n      !$scope.RequisitionStatus.Confirmed &&\r\n      !$scope.RequisitionStatus.InStore &&\r\n      !$scope.RequisitionStatus.Draft &&\r\n      !$scope.RequisitionStatus.OnTheRoad &&\r\n      !$scope.RequisitionStatus.Acceptance &&\r\n      !$scope.RequisitionStatus.Revocation &&\r\n      !$scope.RequisitionStatus.RawMaterialPending) {\r\n      if ($scope.SearhParams.RezConditions[0] == 2) $scope.RequisitionStatus.Filing = true;\r\n      else if ($scope.SearhParams.RezConditions[0] == 3) $scope.RequisitionStatus.Assignment = true;\r\n      else if ($scope.SearhParams.RezConditions[0] == 32) $scope.RequisitionStatus.Confirmed = true;\r\n      else if ($scope.SearhParams.RezConditions[0] == 8) $scope.RequisitionStatus.InStore = true;\r\n      else if ($scope.SearhParams.RezConditions[0] == 4) $scope.RequisitionStatus.Acceptance = true;\r\n      else if ($scope.SearhParams.RezConditions[0] == 5) $scope.RequisitionStatus.Revocation = true;\r\n      else if ($scope.SearhParams.RezConditions[0] == 6) $scope.RequisitionStatus.Draft = true;\r\n      else if ($scope.SearhParams.RezConditions[0] == 91) $scope.RequisitionStatus.RawMaterialPending = true;\r\n    } else {\r\n      $scope.SearhParams.RezConditions = [];\r\n      $scope.RequisitionStatus.Draft ? $scope.SearhParams.RezConditions.push(6) : '';\r\n      $scope.RequisitionStatus.Filing ? $scope.SearhParams.RezConditions.push(2) : '';\r\n      $scope.RequisitionStatus.Confirmed ? $scope.SearhParams.RezConditions.push(32) : '';\r\n      $scope.RequisitionStatus.Assignment ? $scope.SearhParams.RezConditions.push(3) : '';\r\n      $scope.RequisitionStatus.InStore ? $scope.SearhParams.RezConditions.push(8) : '';\r\n      $scope.RequisitionStatus.Acceptance ? $scope.SearhParams.RezConditions.push(4) : '';\r\n      $scope.RequisitionStatus.Revocation ? $scope.SearhParams.RezConditions.push(5) : '';\r\n      $scope.RequisitionStatus.RawMaterialPending ? $scope.SearhParams.RezConditions.push(91) : '';\r\n      $scope.RequisitionStatus.Overtime ? $scope.SearhParams.Overtime = 1 : '';\r\n      $timeout.cancel(Func_Timeouter_Lock);\r\n      $timeout(function () {\r\n        $scope.TimesForLock = 0;\r\n        $scope.Repair_Time('S');\r\n      }, 100);\r\n    }\r\n  });\r\n  $scope.deliberatelyTrustDangerousSnippet = function (snippet) {\r\n    return $sce.trustAsHtml(snippet);\r\n  };\r\n  var Func_Timeouter_Lock;\r\n  $scope.Repair_Time = function (Tag) {\r\n    if ($scope.TimesForLock == 100) { //原本 200\r\n      $timeout.cancel(Func_Timeouter_Lock);\r\n      $scope.TimesForLock = 0;\r\n      if (Tag == \"S\") {\r\n        $scope.SearchRepair(1);\r\n        //$scope.GetProvider();\r\n      } else {\r\n        $scope.GetEquipment4Areas();\r\n      }\r\n    } else {\r\n      $scope.TimesForLock = $scope.TimesForLock + 1;\r\n      Func_Timeouter_Lock = $timeout(function () {\r\n        $scope.Repair_Time(Tag);\r\n      }, 1);\r\n    }\r\n  };\r\n  //报修时限\r\n  $scope.EmergencyName = i18n.t(\"11049\");\r\n  $scope.EmergencyIds = [0, 1, 2];\r\n  $scope.InspectionName = i18n.t(\"11049\");\r\n  $scope.IsInspection = 4;\r\n  //王品查询，获取区域\r\n  $scope.getRegions = function () {\r\n    $http({\r\n      url: ApiMapper.sApi + '/s/unit/region',\r\n      method: 'GET',\r\n      cache: false,\r\n      contentType: 'application/json',\r\n      headers: {\r\n        'Passport': $cookies.Passport\r\n      }\r\n    }).success(function (res) {\r\n      $scope.RegionList = res;\r\n    }).error(function (res) {\r\n      $scope.RegionList = [];\r\n    });\r\n  };\r\n  /***\r\n   * 2019R5\r\n   * 铃铛提醒资讯案件\r\n   */\r\n  $scope.getFacility = function () {\r\n    $http({\r\n      url: ApiMapper.sApi + '/s/rez/all/count/facility',\r\n      method: 'GET',\r\n      cache: false,\r\n      contentType: 'application/json',\r\n      headers: {\r\n        'Passport': $cookies.Passport\r\n      }\r\n    }).success(function (res) {\r\n      $scope.notifyCount = res;\r\n    }).error(function (res) {\r\n      $scope.notifyCount = 0;\r\n    });\r\n  };\r\n\r\n  // 获取保养案件类型\r\n  $scope.SubTypeSelected = [];\r\n  $scope.getInspectionType = function () {\r\n    $http({\r\n      url: ApiMapper.sApi + '/s/equipmenttype/inspection',\r\n      method: 'GET',\r\n      contentType: 'application/json',\r\n      headers: {\r\n        'Passport': $cookies.Passport\r\n      }\r\n    }).success(function (data) {\r\n      $scope.inspectionType = data;\r\n    }).error(function () {\r\n\r\n    });\r\n  }\r\n  $scope.setInspectionType = function (item) {\r\n    item.Selected = !item.Selected;\r\n    if (item.Selected) {\r\n      $scope.SubTypeSelected.push(item.EquipmentSubTypeId);\r\n      $scope.GroupParames.TypeName.push(item.EquipmentSubTypeName);\r\n      // 添加至查询参数\r\n      $scope.SearhParams.EquipmentSubTypeId.push(item.EquipmentSubTypeId);\r\n    } else {\r\n      var idx = $scope.SubTypeSelected.indexOf(item.EquipmentSubTypeId);\r\n      $scope.SubTypeSelected.splice(idx, 1);\r\n      $scope.GroupParames.TypeName.splice(idx, 1);\r\n\r\n      $scope.SearhParams.EquipmentSubTypeId.splice(idx, 1);\r\n      console.log($scope.SubTypeSelected, $scope.SearhParams.EquipmentSubTypeId)\r\n    }\r\n  }\r\n  /**/\r\n  //取得門店資料\r\n  $scope.GetStore = function () {\r\n    $http({\r\n      url: ApiMapper.sApi + '/s/unit/maps',\r\n      method: 'GET',\r\n      cache: false,\r\n      contentType: 'application/json',\r\n      headers: {\r\n        'Passport': $cookies.Passport\r\n      }\r\n    }).success(function (Unitdata) {\r\n      $scope.StoreList = [];\r\n      $scope.Unitdata = Unitdata;\r\n      _.forEach($scope.Unitdata[1],function (Item1) { // + '[' + Item1.UnitId + ']'\r\n        $scope.StoreList.push({\r\n          'Id': Item1.UnitId,\r\n          'Text': Item1.Unit,\r\n          'isSelected': false,\r\n          'Level1': '',\r\n          'Level2': '',\r\n          'UnitLevel': 10\r\n        });\r\n        _.forEach($scope.Unitdata[2],function (Item2) {\r\n          if (Item2.Level2 == Item1.UnitId) { //+ '[' + Item2.UnitId + ']'\r\n            $scope.StoreList.push({\r\n              'Id': Item2.UnitId,\r\n              'Text': '　' + Item2.Unit,\r\n              'isSelected': false,\r\n              'Level1': '',\r\n              'Level2': '',\r\n              'UnitLevel': 20\r\n            });\r\n            _.forEach($scope.Unitdata[3],function (Item3) {\r\n              if (Item3.Level3 == Item2.UnitId) { //+ '[' + Item3.UnitId + ']'\r\n                $scope.StoreList.push({\r\n                  'Id': Item3.UnitId,\r\n                  'Text': '　　' + Item3.Unit,\r\n                  'isSelected': false,\r\n                  'Level1': Item1.UnitId,\r\n                  'Level2': Item2.UnitId,\r\n                  'UnitLevel': 100\r\n                });\r\n              }\r\n              if (Item3.UnitId == $cookies.UnitId) {\r\n                $scope.SearhParams.UnitIds.push(Item3.UnitId);\r\n                $scope.UnitIds.push(Item3.UnitId);\r\n                $scope.Unit = Item3.Unit;\r\n                $scope.Select2List = [{\r\n                  \"Id\": Item3.UnitId,\r\n                  \"Text\": Item3.Unit\r\n                }];\r\n                $scope.StoreSelectedList = $scope.Select2List;\r\n                $scope.SelectedList01 = $scope.Select2List;\r\n                $scope.GetEquipment4Areas();\r\n                $scope.GetProvider();\r\n              }\r\n            });\r\n          }\r\n        });\r\n        //$scope.StoreList.push(ParentItem); \r\n      });\r\n      $scope.Select2Data01 = $scope.StoreList;\r\n    });\r\n  };\r\n  //取得维修商資料 \r\n  $scope.GetProvider = function () {\r\n    if ($scope.UnitIds.length > 0) {\r\n      $http({\r\n        url: ApiMapper.sApi + '/s/rez/misc/spCategory',\r\n        method: 'POST',\r\n        cache: false,\r\n        contentType: 'application/json',\r\n        headers: {\r\n          'Passport': $cookies.Passport\r\n        },\r\n        data: {\r\n          'UnitIds': $scope.UnitIds,\r\n          'RequisitionStatus': [1, 2, 4, 5, 6]\r\n        }\r\n      }).success(function (Unitdata) {\r\n        $scope.pcompanyName = '';\r\n        $scope.pcompanyList = [];\r\n        _.forEach(Unitdata,function(Item) {\r\n          $scope.pcompanyList.push({\r\n            'Id': Item.MaintainerId,\r\n            'Text': Item.MaintainerName,\r\n            'isSelected': false\r\n          });\r\n          $scope.Select2Data02.push({\r\n            'Id': Item.MaintainerId,\r\n            'Text': Item.MaintainerName,\r\n            'isSelected': false\r\n          });\r\n        });\r\n\r\n      });\r\n    }\r\n  };\r\n  if (parseInt($scope.StoreUser) === 0) {\r\n    $scope.GetStore();\r\n  } else {\r\n    $scope.UnitIds = [$cookies.UnitId];\r\n    $scope.GetProvider();\r\n  }\r\n  //获取设备类别和设备\r\n  $scope.GetEquipment4Areas = function () {\r\n    //$scope.SearhParams.positionIds = $scope.AreasSelected;\r\n    $scope.EquipmentList = [];\r\n    $http({\r\n      url: ApiMapper.sApi + '/s/rez/misc/etCategory',\r\n      cache: false,\r\n      method: 'POST',\r\n      contentType: 'application/json',\r\n      headers: {\r\n        'Passport': $cookies.Passport\r\n      },\r\n      data: JSON.stringify({\r\n        'UnitIds': $scope.UnitIds,\r\n        'RequisitionStatus': [1, 2, 4, 5, 6]\r\n      })\r\n    }).success(function (data) {\r\n      _.forEach(data,function(Lists) { //+ '[' + Lists.EquipmentCode + ']'\r\n        $scope.EquipmentList.push({\r\n          'Id': Lists.EquipmentId,\r\n          'Text': Lists.EquipmentName,\r\n          'isSelected': false\r\n        });\r\n        $scope.Select2Data03.push({\r\n          'Id': Lists.EquipmentId,\r\n          'Text': Lists.EquipmentName,\r\n          'isSelected': false\r\n        });\r\n      });\r\n    }).error(function (data) {\r\n      $scope.isShowList = true;\r\n    });\r\n  };\r\n\r\n  //禁用按钮\r\n  $scope.isShowButton = function (Tag, n) {\r\n    var ItemId = $scope.Select2List[n].Id;\r\n    if (Tag == \"ADD\") {\r\n      if (ItemId == \"\") {\r\n        return true;\r\n      } else if (n == 0 && $scope.Select2List.length > 1) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    } else {\r\n      if (n == 0 && $scope.Select2List.length == 1 && (ItemId == \"\" || ItemId == null)) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  };\r\n  //新增报修项目\r\n  $scope.AddToSelect2 = function (Index) {\r\n    if (!$scope.isShowButton('ADD', Index)) {\r\n      $scope.Select2List.push({\r\n        'Id': '',\r\n        'text': ''\r\n      });\r\n    }\r\n  };\r\n  //删除报修项目\r\n  $scope.RemoveForSelect2 = function (Index) {\r\n    if (!$scope.isShowButton('Delete', Index)) {\r\n      if ($scope.Select2List.length > 1) {\r\n        $scope.Select2List.splice(Index, 1);\r\n      } else {\r\n        $scope.Select2List = [{\r\n          \"Id\": \"\",\r\n          \"Text\": \"\"\r\n        }];\r\n        if ($scope.tabId == \"Store\") {\r\n          $scope.Select2Data01 = [];\r\n          $scope.SelectedList01 = [];\r\n        } else if ($scope.tabId == \"Maintainer\") {\r\n          $scope.Select2Data02 = [];\r\n          $scope.SelectedList02 = [];\r\n        } else {\r\n          $scope.Select2Data03 = [];\r\n          $scope.SelectedList03 = [];\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  //加载进阶选择页签于资料\r\n  $scope.LoadMnti = function (n) {\r\n    if (parseInt(n) == 0) {\r\n      $scope.tabName = i18n.t(\"2081\");\r\n      $scope.tabId = \"Store\";\r\n      $scope.Select2Data = $scope.StoreList;\r\n      if ($scope.SelectedList01.length > 0) {\r\n        $scope.Select2List = $scope.SelectedList01;\r\n      } else {\r\n        $scope.Select2List = [{\r\n          \"Id\": \"\",\r\n          \"Text\": \"\"\r\n        }];\r\n      }\r\n\r\n    } else if (parseInt(n) == 1) {\r\n      $scope.tabName = i18n.t(\"2085\");\r\n      $scope.tabId = \"Maintainer\";\r\n      $scope.Select2Data = $scope.pcompanyList;\r\n      if ($scope.SelectedList02.length > 0) {\r\n        $scope.Select2List = $scope.SelectedList02;\r\n      } else {\r\n        $scope.Select2List = [{\r\n          \"Id\": \"\",\r\n          \"Text\": \"\"\r\n        }];\r\n      }\r\n    } else {\r\n      $scope.tabName = i18n.t(\"11129\");\r\n      $scope.tabId = \"Equipment\";\r\n      $scope.Select2Data = $scope.EquipmentList;\r\n      if ($scope.SelectedList03.length > 0) {\r\n        $scope.Select2List = $scope.SelectedList03;\r\n      } else {\r\n        $scope.Select2List = [{\r\n          \"Id\": \"\",\r\n          \"Text\": \"\"\r\n        }];\r\n      }\r\n    }\r\n  };\r\n  //文本框获取焦点\r\n  $scope.rSetSelect2Values = function (Item) {\r\n    Item.isSelected = false;\r\n    Item.Text = \"\";\r\n    Item.Id = \"\";\r\n  };\r\n  //文本关键字查询--高亮\r\n  $scope.SetFiterHighlight = function (Select2Item) {\r\n    $scope.Select2Data = [];\r\n    if ($scope.tabId == \"Store\") {\r\n      _.forEach($scope.StoreList,function(Item) {\r\n        var ItemObject = Item;\r\n        var ItemText = Item.Text;\r\n        ItemText = ItemText.replace(\"<span style='color:red;'>\", \"\");\r\n        Item.Text = ItemText.replace(\"</span>\", \"\");\r\n        if (Select2Item.Text != \"\" && ItemText.indexOf(Select2Item.Text) >= 0) {\r\n          var nTextStr = \"<span style='color:red;'>\" + Select2Item.Text + \"</span>\";\r\n          ItemObject.Text = ItemText.replace(Select2Item.Text, nTextStr);\r\n          $scope.Select2Data.push({\r\n            'Id': Item.Id,\r\n            'Text': ItemText.replace(Select2Item.Text, nTextStr)\r\n          });\r\n\r\n          ItemText = ItemText.replace(\"<span style='color:red;'>\", \"\");\r\n          Item.Text = ItemText.replace(\"</span>\", \"\");\r\n        }\r\n      });\r\n    } else if ($scope.tabId == \"Maintainer\") {\r\n      _.forEach($scope.pcompanyList,function(Item) {\r\n        var ItemObject = Item.Text;\r\n        var ItemText = Item.Text;\r\n        ItemText = ItemText.replace(\"<span style='color:red;'>\", \"\");\r\n        Item.Text = ItemText.replace(\"</span>\", \"\");\r\n        if (Select2Item.Text != \"\" && ItemText.indexOf(Select2Item.Text) >= 0) {\r\n          var nTextStr = \"<span style='color:red;'>\" + Select2Item.Text + \"</span>\";\r\n          ItemObject.Text = ItemText.replace(Select2Item.Text, nTextStr);\r\n          $scope.Select2Data.push({\r\n            'Id': Item.Id,\r\n            'Text': ItemText.replace(Select2Item.Text, nTextStr)\r\n          });\r\n\r\n          ItemText = ItemText.replace(\"<span style='color:red;'>\", \"\");\r\n          Item.Text = ItemText.replace(\"</span>\", \"\");\r\n        }\r\n      });\r\n    } else {\r\n      _.forEach($scope.EquipmentList,function(Item) {\r\n        var ItemObject = Item.Text;\r\n        var ItemText = Item.Text;\r\n        ItemText = ItemText.replace(\"<span style='color:red;'>\", \"\");\r\n        Item.Text = ItemText.replace(\"</span>\", \"\");\r\n        if (Select2Item.Text != \"\" && ItemText.indexOf(Select2Item.Text) >= 0) {\r\n          var nTextStr = \"<span style='color:red;'>\" + Select2Item.Text + \"</span>\";\r\n          ItemObject.Text = ItemText.replace(Select2Item.Text, nTextStr);\r\n          $scope.Select2Data.push({\r\n            'Id': Item.Id,\r\n            'Text': ItemText.replace(Select2Item.Text, nTextStr)\r\n          });\r\n\r\n          ItemText = ItemText.replace(\"<span style='color:red;'>\", \"\");\r\n          Item.Text = ItemText.replace(\"</span>\", \"\");\r\n        }\r\n      });\r\n    }\r\n  };\r\n  //设定Select2选中值\r\n  $scope.SetSelect2Values = function (Item, n) {\r\n    $(\".NT_side_footer\").removeClass('unfixed');\r\n    Item.isSelected = !Item.isSelected;\r\n    var ItemText = $scope.Select2Data[n].Text;\r\n    ItemText = ItemText.replace(\"　\", \"\");\r\n    ItemText = ItemText.replace(\"　\", \"\");\r\n    ItemText = ItemText.replace(\"<span style='color:red;'>\", \"\");\r\n    ItemText = ItemText.replace(\"</span>\", \"\");\r\n    Item.Text = ItemText;\r\n    Item.Id = $scope.Select2Data[n].Id;\r\n\r\n    $timeout(function () {\r\n      if ($scope.tabId == \"Store\") {\r\n        $scope.Select2Data01 = $scope.Select2Data;\r\n        $scope.SelectedList01 = _.uniq($scope.Select2List);\r\n      } else if ($scope.tabId == \"Maintainer\") {\r\n        $scope.Select2Data02 = $scope.Select2Data;\r\n        $scope.SelectedList02 = $scope.Select2List;\r\n      } else {\r\n        $scope.Select2Data03 = $scope.Select2Data;\r\n        $scope.SelectedList03 = $scope.Select2List;\r\n      }\r\n    }, 300);\r\n  };\r\n\r\n  var resetAllParams = function () {\r\n    $scope.RequestTime = {\r\n      \"StartDate\": null,\r\n      \"EndDate\": null\r\n    };\r\n    $scope.Emergency = {\r\n      'Yes': true,\r\n      'Normal': true,\r\n      'DontCare': false\r\n    };\r\n    $scope.RequisitionStatus = {\r\n      \"Filing\": false,\r\n      \"Assignment\": true,\r\n      \"InStore\": true,\r\n      \"Acceptance\": false,\r\n      \"Revocation\": false,\r\n      \"OnConfirm\": false,\r\n      \"OnProcess\": false,\r\n      \"RawMaterialPending\": false\r\n    };\r\n\r\n    $scope.SearhParams = {\r\n      'UnitIds': [],\r\n      'MaintainerIds': [],\r\n      'EquipmentIds': [],\r\n      'FuzzyCaseCode': null,\r\n      'RezConditions': [3],\r\n      'Emergency': [0, 1, 2],\r\n      'IsInspection': 4,\r\n      'UnitRegionIds': [],\r\n      'UnitDivisionIds': [],\r\n      'EquipmentTypeClass': [0, 1],\r\n      'EquipmentSubTypeId': [],\r\n      'Orders': $scope.OrderbyParames\r\n    };\r\n  };\r\n  //清除所有选择\r\n  $scope.clearSelect2Values = function () {\r\n    resetAllParams();\r\n    $scope.Select2Data01 = $scope.StoreList;\r\n    $scope.Select2Data02 = $scope.pcompanyList;\r\n    $scope.Select2Data03 = $scope.EquipmentList;\r\n\r\n    $scope.StoreSelectedList = [];\r\n    $scope.MaintainerSelectedList = [];\r\n    $scope.EquipmentSelectedList = [];\r\n    _.forEach($scope.Select2List,function(Item, n) {\r\n      Item.Id = \"\";\r\n      Item.Text = \"\";\r\n    });\r\n    _.forEach($scope.Select2Data01,function(Item) {\r\n      Item.isSelected = false;\r\n    });\r\n    _.forEach($scope.SelectedList01,function(Item) {\r\n      Item.isSelected = false;\r\n    });\r\n    _.forEach($scope.SelectedList02,function(Item) {\r\n      Item.isSelected = false;\r\n    });\r\n    _.forEach($scope.SelectedList03,function(Item) {\r\n      Item.isSelected = false;\r\n    });\r\n\r\n    $scope.Unit = \"\";\r\n    $scope.closeDenav('Multi');\r\n    $scope.SearchRepair($scope.currentPage);\r\n  };\r\n  //确认查询\r\n  $scope.gotoSearch = function () {\r\n    //$scope.StoreList = $scope.Select2Data01;\r\n    //$scope.pcompanyList = $scope.Select2Data02;\r\n    //$scope.EquipmentList = $scope.Select2Data03;\r\n    $scope.SearhParams.UnitIds = [];\r\n    $scope.SearhParams.MaintainerIds = [];\r\n    $scope.SearhParams.EquipmentIds = [];\r\n    var UnitName = [];\r\n    _.forEach($scope.StoreSelectedList,function(Item) {\r\n      UnitName.push(Item.Text);\r\n      _.forEach($scope.StoreList,function(Areas) {\r\n        if (Areas.Id == Item.Id || Item.Id == Areas.Level1 || Item.Id == Areas.Level2) {\r\n          $scope.SearhParams.UnitIds.push(Areas.Id);\r\n        }\r\n      });\r\n      $scope.SearhParams.UnitIds.push(Item.Id);\r\n    });\r\n    $scope.Unit = UnitName.toString();\r\n    _.forEach($scope.MaintainerSelectedList,function(Item) {\r\n      if (Item.Id != \"\" && Item.Id != null) {\r\n        $scope.SearhParams.MaintainerIds.push(Item.Id);\r\n      }\r\n    });\r\n    _.forEach($scope.EquipmentSelectedList,function(Item) {\r\n      if (Item.Id != \"\" && Item.Id != null) {\r\n        $scope.SearhParams.EquipmentIds.push(Item.Id);\r\n      }\r\n    });\r\n    $scope.closeDenav('Multi');\r\n    $scope.SearchRepair($scope.currentPage);\r\n  };\r\n  /*\r\n   *王品2019R5新增功能\r\n   *\r\n   */\r\n  $scope.clearSelect2GroupValues = function () {\r\n    $scope.SearhParams.UnitRegionIds = [];\r\n    $scope.SearhParams.Emergency = [0, 1, 2];\r\n    $scope.SearhParams.EquipmentSubTypeId = [];\r\n    $scope.SearhParams.IsInspection = 4;\r\n\r\n    $scope.GroupParames = {\r\n      \"Regions\": [],\r\n      \"Emergencys\": [i18n.t(\"11074\"), i18n.t(\"11075\")],\r\n      \"TypeName\": []\r\n    };\r\n\r\n    $scope.Emergency = {\r\n      'Yes': true,\r\n      'Normal': true,\r\n      'DontCare': false\r\n    };\r\n    console.log($scope.Emergency);\r\n    $scope.SubTypeSelected = [];\r\n    _.forEach($scope.inspectionType,function(item) {\r\n      item.Selected = false;\r\n    });\r\n    $scope.closeDenav('Group');\r\n    $scope.GetCaseCount();\r\n  };\r\n  $scope.gotoGroupSearch = function () {\r\n    $scope.closeDenav('Group');\r\n    $scope.GetCaseCount();\r\n  };\r\n  //资讯案件提醒事件\r\n  $scope.getNotifyList = function () {\r\n    $scope.SearhParams.EquipmentTypeClass = [1];\r\n    $scope.SearhParams.RezConditions = [2];\r\n    $scope.SearhParams.IsInspection = 4;\r\n\r\n    $scope.SearchRepair(1);\r\n    $scope.WPUIpage = 'listPage';\r\n  };\r\n\r\n  //清除所有选择\r\n  $scope.clearSelect2Values4Item = function () {\r\n    //$(\".NT_side_footer\").removeClass('unfixed');\r\n    _.forEach($scope.Select2List,function(Item, n) {\r\n      Item.Id = \"\";\r\n      Item.Text = \"\";\r\n    });\r\n    _.forEach($scope.Select2Data,function(Item) {\r\n      Item.isSelected = false;\r\n    });\r\n    if ($scope.tabId == \"Store\") {\r\n      $scope.StoreList = $scope.Select2Data;\r\n    } else if ($scope.tabId == \"Maintainer\") {\r\n      $scope.pcompanyList = $scope.Select2Data;\r\n    } else {\r\n      $scope.EquipmentList = $scope.Select2Data;\r\n    }\r\n  };\r\n  //获取下层资料\r\n  $scope.loadSelect2Data4Item = function () {\r\n    if ($scope.tabId == \"Store\") {\r\n      $scope.StoreSelectedList = _.uniq($scope.SelectedList01);\r\n      $scope.UnitIds = [];\r\n      var UnitName = [];\r\n      _.forEach($scope.StoreSelectedList,function(Item) {\r\n        UnitName.push(Item.Text);\r\n        _.forEach($scope.Select2Data01,function(Areas) {\r\n          if (Areas.Id == Item.Id || Item.Id == Areas.Level1 || Item.Id == Areas.Level2) {\r\n            $scope.UnitIds.push(Areas.Id);\r\n          }\r\n        });\r\n        $scope.UnitIds.push(Item.Id);\r\n      });\r\n      $scope.GetProvider();\r\n      $scope.GetEquipment4Areas();\r\n\r\n      $scope.Unit = UnitName.toString();\r\n      $scope.MaintainerSelectedList = [];\r\n      $scope.EquipmentSelectedList = [];\r\n    } else if ($scope.tabId == \"Maintainer\") {\r\n      $scope.MaintainerSelectedList = $scope.SelectedList02;\r\n    } else {\r\n      $scope.EquipmentSelectedList = $scope.SelectedList03;\r\n    }\r\n  };\r\n  //加载查询条件\r\n  $scope.loadSearchParams = function (e) {\r\n    if (e == \"No\") {\r\n      window.location.href = \"search_no.html\";\r\n    } else {\r\n      window.location.href = \"search_muti.html\";\r\n    }\r\n  };\r\n\r\n  // 重新查詢\r\n  $scope.$on(\"ReloadSearch\", function (event, data) {\r\n    $scope.SearchRepair($scope.currentPage);\r\n  });\r\n\r\n  //列表查询\r\n  $scope.SearchRepair = function (currentPage) {\r\n    $scope.isShowMore = false;\r\n\r\n    if (parseInt(currentPage) > 0) {\r\n      $scope.currentPage = currentPage;\r\n    } else {\r\n      $scope.currentPage = 1;\r\n    }\r\n    //加载更多内容不显示loading动画\r\n    if ($scope.currentPage <= 1) {\r\n      $scope.isLoading = true;\r\n    }\r\n    if ($scope.Search4No) {\r\n      $scope.isLoading = true;\r\n      $scope.SearhParams.UnitIds = [];\r\n      $scope.SearhParams.MaintainerIds = [];\r\n      $scope.SearhParams.EquipmentIds = [];\r\n    } else {\r\n      $scope.SearhParams.RequestTime = [];\r\n      $scope.RequestTime.StartDate == null ? '' : $scope.SearhParams.RequestTime.push($scope.RequestTime.StartDate);\r\n      $scope.RequestTime.EndDate == null ? '' : $scope.SearhParams.RequestTime.push($scope.RequestTime.EndDate);\r\n    }\r\n    //排序\r\n    //$scope.SearhParams.Orders = $scope.OrderbyParames;\r\n    //设备报修时限\r\n    //$scope.SearhParams.Emergency = $scope.EmergencyIds; //alert(JSON.stringify($scope.SearhParams));\r\n    //$scope.SearhParams.IsInspection = $scope.IsInspection;\r\n    //不是正式機的APPID也不是測試機的AppId 就是別人的AppId\r\n    //使用Appid判斷是否散戶查詢 如果是傳送的data須加上openid\r\n    var SearhParams = $scope.SearhParams;\r\n    if (\r\n      $scope.AppId == 'wxb04d43e40105795a' ||\r\n      $scope.AppId == 'wxb39ebe28ba7036a5'\r\n    ) {\r\n      SearhParams = $scope.SearhParams;\r\n    } else {\r\n      SearhParams.OpenId = $scope.OpenId;\r\n    }\r\n    //console.log(SearhParams);\r\n\r\n    $http({\r\n      url: ApiMapper.sApi + '/s/rez/f/' + $scope.currentPage,\r\n      method: 'POST',\r\n      contentType: 'application/json',\r\n      headers: {\r\n        'Passport': $cookies.Passport\r\n      },\r\n      data: JSON.stringify(SearhParams)\r\n    }).success(function (data) {\r\n      if ($scope.currentPage == 1) {\r\n        $scope.RepairList = [];\r\n      }\r\n      console.log(data[2]);\r\n      if (data[2] > 0) {\r\n        $scope.isShowDetail = true;\r\n        $scope.RepairCounts = parseInt(data[0]);\r\n        $scope.isShowMore = $scope.RepairCounts > 1 ? true : false;\r\n        if ($scope.currentPage == $scope.RepairCounts) {\r\n          $scope.isShowMore = false;\r\n        } else {\r\n          $scope.isShowMore = true;\r\n        }\r\n        _.forEach(data[1],function (Item) {\r\n          Item.Selected = false;\r\n          Item.swipeState = false;\r\n        });\r\n        Array.prototype.push.apply($scope.RepairList, data[1]);\r\n      } else {\r\n        $scope.isShowDetail = false;\r\n        $scope.isShowMore = false;\r\n      }\r\n      $scope.isLoading = false;\r\n    }).error(function () {\r\n      $scope.isLoading = false;\r\n    });\r\n  };\r\n  //加载更多\r\n  $scope.LoadMore = function () {\r\n    $scope.currentPage = $scope.currentPage + 1;\r\n    $scope.SearchRepair($scope.currentPage);\r\n    if ($scope.currentPage == $scope.RepairCounts) {\r\n      $scope.isShowMore = false;\r\n    }\r\n  };\r\n  //保修单号查询\r\n  $scope.SetCaseCode = function () {\r\n    $scope.SearhParams.UnitIds = [];\r\n    $scope.SearhParams.MaintainerIds = [];\r\n    $scope.SearhParams.EquipmentIds = [];\r\n    $timeout.cancel(Func_Timeouter_Lock);\r\n    $timeout(function () {\r\n      $scope.TimesForLock = 0;\r\n      $scope.Repair_Time('S');\r\n    }, 100);\r\n  };\r\n  //回调函数\r\n  $scope.ForCallback = function () {\r\n    $timeout(function () {\r\n      $scope.SearchRepair($scope.currentPage);\r\n    }, 200);\r\n  };\r\n  // $scope.ForCallback();\r\n\r\n  //关闭 Sidenav\r\n  $scope.CloseSidenav = function (navID) {\r\n    $mdSidenav(navID).close()\r\n      .then(function () {});\r\n  };\r\n  //加载案件详情\r\n  $scope.GetDetail = function (RepairItem, Tag) {\r\n    window.localStorage.setItem(\"DetailId\", RepairItem.RequisitionId);\r\n    if (Tag == \"Sign\") {\r\n      $mdSidenav('right_cancel_sign').toggle();\r\n    } else {\r\n      $scope.$broadcast(\"RepairList2Detail\", RepairItem.RequisitionId);\r\n      $mdSidenav('RepairDetail').toggle();\r\n      //location.href = \"Case_Detail.html?requisitionId=\" + RepairItem.RequisitionId;\r\n    }\r\n    $scope.RepairInfo = {};\r\n    $scope.CheckedIds = [];\r\n    // $http({\r\n    //     url: ApiMapper.sApi + '/s/rez/' + RepairItem.RequisitionId,\r\n    //     method: 'GET',\r\n    //     contentType: 'application/json',\r\n    //     headers: { 'Passport': $cookies.Passport }\r\n    // }).success(function (data) {\r\n    //     $scope.RepairInfo = data;\r\n    //     if ($scope.RepairInfo.EstArrivalTime != null && $scope.RepairInfo.EstArrivalTime != \"\")\r\n    //         $scope.RepairInfo.EstArrivalTime = $filter('date')(new Date($scope.RepairInfo.EstArrivalTime), 'yyyy/MM/dd HH:mm:ss');\r\n\r\n    //     if ($scope.RepairInfo.DateA != null && $scope.RepairInfo.DateA != \"\")\r\n    //         $scope.RepairInfo.DateA = $filter('date')(new Date($scope.RepairInfo.DateA), 'yyyy/MM/dd HH:mm:ss');\r\n    //     if (Tag == \"Sign\") {\r\n    //         $scope.GetCheckinHistories(Id);\r\n    //     }\r\n    //     $scope.RepairInfo.IntervalAB = $scope.M2H($scope.RepairInfo.IntervalAB);\r\n    //     $scope.RepairInfo.IntervalBC = $scope.M2H($scope.RepairInfo.IntervalBC);\r\n    //     $scope.RepairInfo.IntervalCD = $scope.M2H($scope.RepairInfo.IntervalCD);\r\n    //     $scope.RepairInfo.IntervalAD = $scope.M2H($scope.RepairInfo.IntervalAD);\r\n    //     if ($scope.RepairInfo.StageId != 100 && $scope.RepairInfo.StageId != -100) {\r\n    //         if ($scope.RepairInfo.DateB != '' && $scope.RepairInfo.DateB != null) {\r\n    //             $scope.isAcceptance = true;\r\n    //         }\r\n    //     }\r\n    //     if (parseInt($scope.RepairInfo.IsLocked) == 1) {\r\n    //         if ($scope.RepairInfo.PreservedUserId != $cookies.UserId) {\r\n    //             alert($scope.RepairInfo.PreservedUserName + '正在编辑此案件,编辑完成后才可新增案件记录！');\r\n    //             return false;\r\n    //         } else if ($scope.RepairInfo.PreservedUserId == $cookies.UserId) {\r\n    //         }\r\n    //     }\r\n    //     //获取报修原因与备注\r\n    //     $scope.GetCause();\r\n    //     $scope.GetEquipmentpos();\r\n    //     $scope.GetUnitInfo();\r\n    //     $scope.getHistory();\r\n    // });\r\n  };\r\n  //获取区域(案件详情)\r\n  $scope.GetEquipmentpos = function () {\r\n    if ($scope.RepairInfo.IPositionIds != null) {\r\n      var IPositionIds = $scope.RepairInfo.IPositionIds;\r\n      if (IPositionIds != '') {\r\n        $http({\r\n          url: ApiMapper.sApi + '/s/equipmentpos/' + $scope.RepairInfo.EquipmentId,\r\n          method: 'GET',\r\n          contentType: 'application/json',\r\n          headers: {\r\n            'Passport': $cookies.Passport\r\n          },\r\n          cache: false\r\n        }).success(function (data) {\r\n          $scope.Equipmentpos = _(data).filter(function (Item) {\r\n            return IPositionIds.indexOf(Item.PositionId) >= 0;\r\n          });\r\n        });\r\n      }\r\n    }\r\n  };\r\n  //获取报修进度列表\r\n  $scope.getHistory = function () {\r\n    $http({\r\n      url: ApiMapper.sApi + '/s/rez/history/' + $scope.RepairInfo.RequisitionId,\r\n      method: 'GET',\r\n      contentType: 'application/json',\r\n      headers: {\r\n        'Passport': $cookies.Passport\r\n      }\r\n    }).success(function (data) {\r\n      if (data.length > 0) {\r\n        data = data.reverse();\r\n        $scope._TableData = data;\r\n        _.forEach($scope._TableData,function(Item) {\r\n          Item.ResponseTime = $filter('date')(new Date(Item.ResponseTime), 'yyyy/MM/dd HH:mm:ss');\r\n        });\r\n        if ($scope._TableData.length > 0) {\r\n          $scope.isTimeline = true;\r\n        }\r\n      }\r\n    });\r\n  };\r\n  //获取单位信息\r\n  $scope.GetUnitInfo = function () {\r\n    //获取部门信息\r\n    $http({\r\n      url: ApiMapper.sApi + '/s/unit/' + Base64.encode($scope.RepairInfo.UnitId),\r\n      method: 'GET',\r\n      contentType: 'application/json',\r\n      headers: {\r\n        'Passport': $cookies.Passport\r\n      },\r\n      cache: false\r\n    }).success(function (data) {\r\n      $scope.DeptInfo = data;\r\n    });\r\n  };\r\n  //获取打卡历程\r\n  $scope.GetCheckinHistories = function (Id) {\r\n    $http({\r\n      url: ApiMapper.sApi + '/s/checkin/' + Id,\r\n      method: 'GET',\r\n      contentType: 'application/json',\r\n      headers: {\r\n        'Passport': $cookies.Passport\r\n      }\r\n    }).success(function (data) {\r\n      $scope.RepairInfo.CheckinHistories = [];\r\n      _.forEach(data,function(Item) {\r\n        Item.Selected = false;\r\n      });\r\n      $scope.RepairInfo.CheckinHistories = data;\r\n    });\r\n  };\r\n  //时间转换(分钟转为小时)\r\n  $scope.M2H = function (mm) {\r\n    var hh = 0;\r\n    var _mm = 0;\r\n    hh = mm / 60;\r\n    _mm = mm % 60 * 100 / 60;\r\n    hh = '' + hh + '.' + _mm;\r\n    return parseFloat(hh).toFixed(2);\r\n  };\r\n  //部门选择關閉滑出頁面\r\n  $scope.SetStore = function (e) {\r\n    $mdSidenav('Store').close()\r\n      .then(function () {\r\n        if (e != \"\") {\r\n          //將門店資料帶回\r\n          $scope.SearhParams = {\r\n            'UnitIds': [],\r\n            'RequisitionStatus': $scope.SearhParams.RezConditions\r\n          };\r\n          $scope.Unit = e.Unit;\r\n          $scope.SearhParams.UnitIds.push(e.UnitId);\r\n          $scope.GetProvider();\r\n          $scope.GetAreas();\r\n        }\r\n      });\r\n  };\r\n  //維修商查询\r\n  $scope.SetMaintainer = function (e) {\r\n    $mdSidenav('Maintainer').close()\r\n      .then(function () {\r\n        $scope.SearhParams = {\r\n          'UnitIds': $scope.SearhParams.UnitIds,\r\n          'RequisitionStatus': $scope.SearhParams.RezConditions,\r\n          'MaintainerIds': []\r\n        };\r\n        //排序\r\n        $scope.SearhParams.Orders = $scope.OrderbyParames;\r\n        $scope.pcompanyName = e.MaintainerName;\r\n        $scope.SearhParams.MaintainerIds.push(e.MaintainerId);\r\n        $scope.SearchRepair(1);\r\n      });\r\n  };\r\n  //依设备编号查询\r\n  $scope.ECodeSearch = function (Equipment) {\r\n    $mdSidenav('right-Area').close()\r\n      .then(function () {\r\n        $scope.SearhParams = {\r\n          'UnitIds': $scope.SearhParams.UnitIds,\r\n          'EquipmentIds': [],\r\n          'RequisitionStatus': $scope.SearhParams.RezConditions\r\n        };\r\n        //排序\r\n        $scope.SearhParams.Orders = $scope.OrderbyParames;\r\n        $scope.EquipmentName = Equipment.EquipmentName;\r\n        $scope.SearhParams.EquipmentIds.push(Equipment.EquipmentId);\r\n        $scope.SearchRepair(1);\r\n      });\r\n  };\r\n  $scope.exists = function (item, list) {\r\n    return list.indexOf(item) > -1;\r\n  };\r\n  //选择区域\r\n  $scope.SetAreas = function (item) {\r\n    $scope.EquipmentName = '';\r\n    $scope.SearhParams.EquipmentIds = [];\r\n    var idx = $scope.AreasSelected.indexOf(item.PositionId);\r\n    if (idx > -1) {\r\n      $scope.AreasSelected.splice(idx, 1);\r\n      $scope.itemsAreaStr.splice(idx, 1);\r\n    } else {\r\n      $scope.AreasSelected.push(item.PositionId);\r\n      $scope.itemsAreaStr.push(item.Region + '-' + item.Position);\r\n    }\r\n    $scope.AreaStr = $scope.itemsAreaStr.toString();\r\n    $scope.SearhParams.positionIds = $scope.AreasSelected;\r\n    //$scope.Timeouter4Areas();\r\n  };\r\n  //区域查询设备延时\r\n  $scope.Timeouter4Areas = function () {\r\n    $timeout.cancel(Func_Timeouter_Lock);\r\n    $scope.TimesForLock = 0;\r\n    $scope.Repair_Time('A');\r\n  };\r\n  //选择打卡记录\r\n  $scope.SetCheckedIds = function (Item) {\r\n    Item.Selected = !Item.Selected;\r\n    var idx = $scope.CheckedIds.indexOf(Item.Id);\r\n    if (idx > -1) {\r\n      $scope.CheckedIds.splice(idx, 1);\r\n    } else {\r\n      $scope.CheckedIds.push(Item.Id);\r\n    }\r\n  };\r\n  //选择报修单\r\n  $scope.SetRequisitions = function (Id) {\r\n    var idx = $scope.RequisitionIds.indexOf(Id);\r\n    if (idx > -1) {\r\n      $scope.RequisitionIds.splice(idx, 1);\r\n    } else {\r\n      $scope.RequisitionIds.push(Id);\r\n    }\r\n  };\r\n  //时间格式\r\n  $scope.FormatDATE = FormatDate;\r\n\r\n  $scope.toggleDenav = function (navID) {\r\n    $mdSidenav(navID).toggle();\r\n  };\r\n\r\n  function buildToggler(navID) {\r\n    var debounceFn = $mdUtil.debounce(function () {\r\n      $mdSidenav(navID)\r\n        .then(function () {});\r\n    }, 300);\r\n    return debounceFn;\r\n  };\r\n  //關閉頁面\r\n  $scope.closeDenav = function (navID) {\r\n    $scope.swipeState = false;\r\n    $mdSidenav(navID)\r\n      .close()\r\n      .then(function () {\r\n\r\n      });\r\n  };\r\n  $scope.onHammer = function onHammer(event) {\r\n    $scope.eventType = event.type;\r\n    //長按則將$scope.longPressSta 設為 false;\r\n    if (event.type == 'press') {\r\n      $scope.longPressSta = false;\r\n      $scope.toggleDenavFN = '';\r\n    }\r\n  };\r\n  //控制icon變化\r\n  $scope.change_openicon = function () {\r\n    if ($scope.CollapseState == false) {\r\n      $scope.CollapseState = true;\r\n    } else {\r\n      $scope.CollapseState = false;\r\n    }\r\n  }\r\n\r\n  // 2018/11/14 新增 王品用\r\n  /**********************/\r\n  /****  選擇分類页面   ***/\r\n  /**********************/\r\n\r\n  // 選擇案件分類-進入列表\r\n  $scope.SelectSearch = function (selectClass, DivisionId, DivisionName) {\r\n    $scope.RepairList = [];\r\n    $scope.RequisitionStatus = {\r\n      \"Filing\": false,\r\n      \"Assignment\": false,\r\n      \"Confirmed\": false,\r\n      \"InStore\": false,\r\n      \"Acceptance\": false,\r\n      \"Revocation\": false,\r\n      \"Overtime\": false,\r\n      \"RawMaterialPending\": false\r\n    };\r\n    // 暂存部門资料\r\n    $scope.DivisionTempData = {\r\n      'DivisionId': DivisionId,\r\n      'DivisionName': DivisionName\r\n    };\r\n    // 傳送選擇的部門\r\n    $scope.SearhParams.UnitDivisionIds = [DivisionId];\r\n    $scope.SearhParams.RequestTime = [];\r\n    switch (selectClass) {\r\n      case i18n.t(\"2002\"):\r\n        $scope.RequisitionStatus.InStore = true;\r\n        $scope.WPUIpage = 'listPage';\r\n        break;\r\n      case i18n.t(\"2003\"):\r\n        $scope.RequisitionStatus.Assignment = true;\r\n        $scope.WPUIpage = 'listPage';\r\n        break;\r\n      case i18n.t(\"2004\"):\r\n        $scope.RequisitionStatus.Filing = true;\r\n        $scope.WPUIpage = 'listPage';\r\n        break;\r\n      case i18n.t(\"2005\"):\r\n        $scope.RequisitionStatus.Confirmed = true;\r\n        $scope.WPUIpage = 'listPage';\r\n        break;\r\n      case i18n.t(\"2006\"):\r\n        $scope.RequestTime = {\r\n          \"StartDate\": GetPreMonth(),\r\n          \"EndDate\": new Date().Format()\r\n        };\r\n        $scope.RequisitionStatus.Acceptance = true;\r\n        $scope.WPUIpage = 'listPage';\r\n        break;\r\n      case i18n.t(\"2008\"):\r\n        $scope.RequestTime = {\r\n          \"StartDate\": GetPreMonth(),\r\n          \"EndDate\": new Date().Format()\r\n        };\r\n        $scope.RequisitionStatus.Revocation = true;\r\n        $scope.WPUIpage = 'listPage';\r\n        break;\r\n    }\r\n  };\r\n\r\n  // 获取案件分类-数字(進行中)\r\n  $scope.GetCaseCount = function () {\r\n    $scope.isLoading = true;\r\n    var paramesStr = {\r\n      'UnitRegionIds': [],\r\n      'EquipmentTypeClass': [0, 1],\r\n      'IsInspection': $scope.SearhParams.IsInspection\r\n    };\r\n    if ($scope.SearhParams.EquipmentTypeClass.length > 0) {\r\n      paramesStr.EquipmentTypeClass = $scope.SearhParams.EquipmentTypeClass;\r\n    }\r\n    if ($scope.SearhParams.UnitRegionIds.length > 0) {\r\n      paramesStr.UnitRegionIds = $scope.SearhParams.UnitRegionIds;\r\n    }\r\n    if ($scope.SearhParams.EquipmentSubTypeId.length > 0) {\r\n      paramesStr.EquipmentSubTypeId = $scope.SearhParams.EquipmentSubTypeId;\r\n    }\r\n    $http({\r\n      // 查詢: 0\r\n      url: ApiMapper.sApi + '/s/rez/all/count/0',\r\n      method: 'POST',\r\n      contentType: 'application/json',\r\n      headers: {\r\n        'Passport': $cookies.Passport\r\n      },\r\n      data: paramesStr\r\n    }).success(function (data) {console.log(data)\r\n      $scope.CaseCountList = data;\r\n      if ($cookies.CompanyId === '308ffed8-d4a7-4ad5-8b61-6cce3c66cd06') {\r\n        _.forEach($scope.CaseCountList,function(item) {\r\n          item.ImgUrl = $cookies.CompanyId;\r\n        });\r\n      } else {\r\n        _.forEach($scope.CaseCountList,function(item) {\r\n          item.ImgUrl = FormatLogoURI(item.DivisionId);\r\n        });\r\n      }\r\n\r\n      $scope.isLoading = false;\r\n    }).error(function (res) {\r\n      $scope.isLoading = false;\r\n    });\r\n  };\r\n\r\n  // 返回-案件分类(清除狀態/獲取分類數字)\r\n  $scope.ClassPage = function () {\r\n    // filter 狀態歸零\r\n    $scope.SearhParams.RezConditions = [];\r\n    $scope.RequisitionStatus = {\r\n      \"Filing\": false,\r\n      \"Assignment\": false,\r\n      \"Confirmed\": false,\r\n      \"InStore\": false,\r\n      \"Acceptance\": false,\r\n      \"Revocation\": false,\r\n      \"Overtime\": false,\r\n      \"RawMaterialPending\": false\r\n    };\r\n    $scope.RepairList = [];\r\n    $scope.currentPage = 1;\r\n\r\n    $scope.WPUIpage = 'selectPage';\r\n    // 重新獲取案件分類數字 \"Identity\"  0:None 1:SVR  2:調度  3:維修師傅\r\n    $scope.GetCaseCount();\r\n  };\r\n\r\n  $scope.callback2case = function () {\r\n    $scope.WPUIpage = 'selectPage';\r\n    $scope.ClassPage();\r\n  };\r\n\r\n  // 王品確認 並且觸發王品專屬功能\r\n  if ($cookies.CompanyId !== '308ffed8-d4a7-4ad5-8b61-6cce3c66cd06') {\r\n    $scope.IsUItoWP = true;\r\n    // filter 狀態歸零\r\n    $scope.SearhParams.RezConditions = [];\r\n    $scope.RequisitionStatus = {\r\n      \"Filing\": false,\r\n      \"Assignment\": false,\r\n      \"Confirmed\": false,\r\n      \"InStore\": false,\r\n      \"Acceptance\": false,\r\n      \"Revocation\": false,\r\n      \"Overtime\": false,\r\n      \"RawMaterialPending\": false\r\n    };\r\n    $scope.RepairList = [];\r\n    $scope.currentPage = 1;\r\n    $scope.isLoading = true;\r\n    $scope.GetCaseCount(); // 載入案件數量\r\n    //2019R5\r\n    $scope.getRegions();\r\n    $scope.getFacility();\r\n    // 20190815\r\n    $scope.getInspectionType();\r\n  } else {\r\n    var _SelectClass = getParameterByName('selectClass');\r\n    // let _DivisionId = getParameterByName('DivisionId');\r\n    // let _DivisionName = getParameterByName('DivisionName');\r\n\r\n    if (!!_SelectClass) {\r\n      $scope.isLoading = true;\r\n      switch (_SelectClass) {\r\n        case 'Arrived':\r\n          _SelectClass = i18n.t(\"2002\");\r\n          break;\r\n        case 'Dispatched':\r\n          _SelectClass = i18n.t(\"2003\");\r\n          break;\r\n        case 'Registered':\r\n          _SelectClass = i18n.t(\"2004\");\r\n          break;\r\n        case 'Confirmed':\r\n          _SelectClass = i18n.t(\"2005\");\r\n          break;\r\n        case 'Acceptance':\r\n          _SelectClass = i18n.t(\"2006\");\r\n          break;\r\n        case 'Revocation':\r\n          _SelectClass = i18n.t(\"2008\");\r\n          break;\r\n      }\r\n      $scope.SelectSearch(_SelectClass, null, null);\r\n    }\r\n  }\r\n}]);"]}