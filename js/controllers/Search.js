"use strict";WeChat.controller("SearchRepairCtrl",["$scope","$http","$timeout","$cookies","$mdSidenav","$mdUtil","$filter","$sce","i18n",function(s,a,n,r,i,e,t,o,c){var p;s.StoreUser=r.StoreUser,s.AppId=ApiMapper.AppId,s.OpenId=window.localStorage.getItem(s.AppId),s.UrlStr=$(location).attr("search")||"Unknown","Unknown"!=s.UrlStr&&(s.RedirectUri=decodeURIComponent(s.UrlStr.split("?redirect_uri=")[1]),s.RedirectUri=s.RedirectUri.replace("&","?"),s.Code=decodeURIComponent(s.UrlStr.split("?code=")[1])),s.getOpenId=function(){if(null==s.OpenId||null==s.OpenId||"null"==s.OpenId)if("undefined"==s.Code||null==s.Code){var e="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+s.AppId+"&redirect_uri="+encodeURIComponent(ApiMapper.PathStr+"search_no.html")+"&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect";location.href=e}else{var t=s.Code.split("&")[0],i=ApiMapper.wxApi+"/wx/r/openId?appId="+s.AppId+"&code="+t;a.get(i).success(function(e){s.OpenId=e.openid,window.localStorage.setItem(s.AppId,s.OpenId)}).error(function(e){wx.closeWindow()})}},s.IsUItoWP=!1,s.WPUIpage="selectPage","eb296708-6fc6-43f0-b506-0ca0fa91e1cd"==r.CompanyId||"6c690014-2571-48db-ac5a-c6ba2572a3bb"==r.CompanyId?(s.IsUItoWP=!0,s.GroupParames={Regions:[],Emergencys:[c.t("11074"),c.t("11075")],TypeName:[]}):(s.IsUItoWP=!1,s.WPUIpage="listPage"),s.FormatLogoURI=FormatLogoURI,s.OrderbyParames=[{name:"DateM",OrderBy:1},{name:"OverTimeInterval",OrderBy:0}],s.SearhParams={UnitIds:[],MaintainerIds:[],EquipmentIds:[],FuzzyCaseCode:null,RezConditions:[3],Emergency:[0,1,2],IsInspection:4,UnitRegionIds:[],UnitDivisionIds:[],EquipmentTypeClass:[0,1],EquipmentSubTypeId:[],Orders:s.OrderbyParames},s.pcompanyList=[],s.StoreList=[],s.Select2List=[{Id:"",Text:""}],s.SelectedList01=[],s.SelectedList02=[],s.SelectedList03=[],s.Select2Data01=[],s.Select2Data02=[],s.Select2Data03=[],s.StoreSelectedList=[],s.MaintainerSelectedList=[],s.EquipmentSelectedList=[],s.UnitIds=[],s.MaintainerIds=[],s.StrongholdIds=[],s.Equipments=[],s.Select2Data=[],s.Select2SelectedList=[],s.tabName=c.t("2081"),s.tabId="Store",s.RepairList=[],s.RepairInfo={},s.RequisitionIds=[],s.AreasSelected=[],s.itemsAreaStr=[],s.CheckedIds=[],s.currentPage=1,s.isLoading=!0,s.isAllSelected=!1,s.isShowMore=!1,s.isShowList=!1,s.isShowDetail=!1,s.Overtime=!1,s.Search4No=!1,s.RepairCounts=0,s.pcompanyName="",s.EquipmentName="",s.Unit=c.t("1001"),s.Survey=5,s.Survey1=5,s.SearchTitle,s.SidenavList=[{name:c.t("2001"),Event:"Muti"},{name:c.t("11128"),Event:"No"}],s.RequestTime={StartDate:null,EndDate:null},s.Emergency={Yes:!0,Normal:!0,DontCare:!1},s.RequisitionStatus={Filing:!1,Assignment:!0,InStore:!0,Acceptance:!1,Revocation:!1,OnConfirm:!1,OnProcess:!1,RawMaterialPending:!1},s.EquipmentList=[],s.$watchCollection("RequisitionStatus",function(){s.RequisitionStatus.Filing||s.RequisitionStatus.Assignment||s.RequisitionStatus.Confirmed||s.RequisitionStatus.InStore||s.RequisitionStatus.Draft||s.RequisitionStatus.OnTheRoad||s.RequisitionStatus.Acceptance||s.RequisitionStatus.Revocation||s.RequisitionStatus.RawMaterialPending?(s.SearhParams.RezConditions=[],s.RequisitionStatus.Draft&&s.SearhParams.RezConditions.push(6),s.RequisitionStatus.Filing&&s.SearhParams.RezConditions.push(2),s.RequisitionStatus.Confirmed&&s.SearhParams.RezConditions.push(32),s.RequisitionStatus.Assignment&&s.SearhParams.RezConditions.push(3),s.RequisitionStatus.InStore&&s.SearhParams.RezConditions.push(8),s.RequisitionStatus.Acceptance&&s.SearhParams.RezConditions.push(4),s.RequisitionStatus.Revocation&&s.SearhParams.RezConditions.push(5),s.RequisitionStatus.RawMaterialPending&&s.SearhParams.RezConditions.push(91),s.RequisitionStatus.Overtime&&(s.SearhParams.Overtime=1),n.cancel(p),n(function(){s.TimesForLock=0,s.Repair_Time("S")},100)):2==s.SearhParams.RezConditions[0]?s.RequisitionStatus.Filing=!0:3==s.SearhParams.RezConditions[0]?s.RequisitionStatus.Assignment=!0:32==s.SearhParams.RezConditions[0]?s.RequisitionStatus.Confirmed=!0:8==s.SearhParams.RezConditions[0]?s.RequisitionStatus.InStore=!0:4==s.SearhParams.RezConditions[0]?s.RequisitionStatus.Acceptance=!0:5==s.SearhParams.RezConditions[0]?s.RequisitionStatus.Revocation=!0:6==s.SearhParams.RezConditions[0]?s.RequisitionStatus.Draft=!0:91==s.SearhParams.RezConditions[0]&&(s.RequisitionStatus.RawMaterialPending=!0)}),s.deliberatelyTrustDangerousSnippet=function(e){return o.trustAsHtml(e)},s.Repair_Time=function(e){100==s.TimesForLock?(n.cancel(p),s.TimesForLock=0,"S"==e?s.SearchRepair(1):s.GetEquipment4Areas()):(s.TimesForLock=s.TimesForLock+1,p=n(function(){s.Repair_Time(e)},1))},s.EmergencyName=c.t("11049"),s.EmergencyIds=[0,1,2],s.InspectionName=c.t("11049"),s.IsInspection=4,s.getRegions=function(){a({url:ApiMapper.sApi+"/s/unit/region",method:"GET",cache:!1,contentType:"application/json",headers:{Passport:r.Passport}}).success(function(e){s.RegionList=e}).error(function(e){s.RegionList=[]})},s.getFacility=function(){a({url:ApiMapper.sApi+"/s/rez/all/count/facility",method:"GET",cache:!1,contentType:"application/json",headers:{Passport:r.Passport}}).success(function(e){s.notifyCount=e}).error(function(e){s.notifyCount=0})},s.SubTypeSelected=[],s.getInspectionType=function(){a({url:ApiMapper.sApi+"/s/equipmenttype/inspection",method:"GET",contentType:"application/json",headers:{Passport:r.Passport}}).success(function(e){s.inspectionType=e}).error(function(){})},s.setInspectionType=function(e){if(e.Selected=!e.Selected,e.Selected)s.SubTypeSelected.push(e.EquipmentSubTypeId),s.GroupParames.TypeName.push(e.EquipmentSubTypeName),s.SearhParams.EquipmentSubTypeId.push(e.EquipmentSubTypeId);else{var t=s.SubTypeSelected.indexOf(e.EquipmentSubTypeId);s.SubTypeSelected.splice(t,1),s.GroupParames.TypeName.splice(t,1),s.SearhParams.EquipmentSubTypeId.splice(t,1),console.log(s.SubTypeSelected,s.SearhParams.EquipmentSubTypeId)}},s.GetStore=function(){a({url:ApiMapper.sApi+"/s/unit/maps",method:"GET",cache:!1,contentType:"application/json",headers:{Passport:r.Passport}}).success(function(e){s.StoreList=[],s.Unitdata=e,_.forEach(s.Unitdata[1],function(i){s.StoreList.push({Id:i.UnitId,Text:i.Unit,isSelected:!1,Level1:"",Level2:"",UnitLevel:10}),_.forEach(s.Unitdata[2],function(t){t.Level2==i.UnitId&&(s.StoreList.push({Id:t.UnitId,Text:"　"+t.Unit,isSelected:!1,Level1:"",Level2:"",UnitLevel:20}),_.forEach(s.Unitdata[3],function(e){e.Level3==t.UnitId&&s.StoreList.push({Id:e.UnitId,Text:"　　"+e.Unit,isSelected:!1,Level1:i.UnitId,Level2:t.UnitId,UnitLevel:100}),e.UnitId==r.UnitId&&(s.SearhParams.UnitIds.push(e.UnitId),s.UnitIds.push(e.UnitId),s.Unit=e.Unit,s.Select2List=[{Id:e.UnitId,Text:e.Unit}],s.StoreSelectedList=s.Select2List,s.SelectedList01=s.Select2List,s.GetEquipment4Areas(),s.GetProvider())}))})}),s.Select2Data01=s.StoreList})},s.GetProvider=function(){0<s.UnitIds.length&&a({url:ApiMapper.sApi+"/s/rez/misc/spCategory",method:"POST",cache:!1,contentType:"application/json",headers:{Passport:r.Passport},data:{UnitIds:s.UnitIds,RequisitionStatus:[1,2,4,5,6]}}).success(function(e){s.pcompanyName="",s.pcompanyList=[],_.forEach(e,function(e){s.pcompanyList.push({Id:e.MaintainerId,Text:e.MaintainerName,isSelected:!1}),s.Select2Data02.push({Id:e.MaintainerId,Text:e.MaintainerName,isSelected:!1})})})},0===parseInt(s.StoreUser)?s.GetStore():(s.UnitIds=[r.UnitId],s.GetProvider()),s.GetEquipment4Areas=function(){s.EquipmentList=[],a({url:ApiMapper.sApi+"/s/rez/misc/etCategory",cache:!1,method:"POST",contentType:"application/json",headers:{Passport:r.Passport},data:JSON.stringify({UnitIds:s.UnitIds,RequisitionStatus:[1,2,4,5,6]})}).success(function(e){_.forEach(e,function(e){s.EquipmentList.push({Id:e.EquipmentId,Text:e.EquipmentName,isSelected:!1}),s.Select2Data03.push({Id:e.EquipmentId,Text:e.EquipmentName,isSelected:!1})})}).error(function(e){s.isShowList=!0})},s.isShowButton=function(e,t){var i=s.Select2List[t].Id;return"ADD"==e?""==i||0==t&&1<s.Select2List.length:0==t&&1==s.Select2List.length&&(""==i||null==i)},s.AddToSelect2=function(e){s.isShowButton("ADD",e)||s.Select2List.push({Id:"",text:""})},s.RemoveForSelect2=function(e){s.isShowButton("Delete",e)||(1<s.Select2List.length?s.Select2List.splice(e,1):(s.Select2List=[{Id:"",Text:""}],"Store"==s.tabId?(s.Select2Data01=[],s.SelectedList01=[]):"Maintainer"==s.tabId?(s.Select2Data02=[],s.SelectedList02=[]):(s.Select2Data03=[],s.SelectedList03=[])))},s.LoadMnti=function(e){0==parseInt(e)?(s.tabName=c.t("2081"),s.tabId="Store",s.Select2Data=s.StoreList,0<s.SelectedList01.length?s.Select2List=s.SelectedList01:s.Select2List=[{Id:"",Text:""}]):1==parseInt(e)?(s.tabName=c.t("2085"),s.tabId="Maintainer",s.Select2Data=s.pcompanyList,0<s.SelectedList02.length?s.Select2List=s.SelectedList02:s.Select2List=[{Id:"",Text:""}]):(s.tabName=c.t("11129"),s.tabId="Equipment",s.Select2Data=s.EquipmentList,0<s.SelectedList03.length?s.Select2List=s.SelectedList03:s.Select2List=[{Id:"",Text:""}])},s.rSetSelect2Values=function(e){e.isSelected=!1,e.Text="",e.Id=""},s.SetFiterHighlight=function(n){s.Select2Data=[],"Store"==s.tabId?_.forEach(s.StoreList,function(e){var t=e,i=e.Text;if(i=i.replace("<span style='color:red;'>",""),e.Text=i.replace("</span>",""),""!=n.Text&&0<=i.indexOf(n.Text)){var a="<span style='color:red;'>"+n.Text+"</span>";t.Text=i.replace(n.Text,a),s.Select2Data.push({Id:e.Id,Text:i.replace(n.Text,a)}),i=i.replace("<span style='color:red;'>",""),e.Text=i.replace("</span>","")}}):"Maintainer"==s.tabId?_.forEach(s.pcompanyList,function(e){var t=e.Text,i=e.Text;if(i=i.replace("<span style='color:red;'>",""),e.Text=i.replace("</span>",""),""!=n.Text&&0<=i.indexOf(n.Text)){var a="<span style='color:red;'>"+n.Text+"</span>";t.Text=i.replace(n.Text,a),s.Select2Data.push({Id:e.Id,Text:i.replace(n.Text,a)}),i=i.replace("<span style='color:red;'>",""),e.Text=i.replace("</span>","")}}):_.forEach(s.EquipmentList,function(e){var t=e.Text,i=e.Text;if(i=i.replace("<span style='color:red;'>",""),e.Text=i.replace("</span>",""),""!=n.Text&&0<=i.indexOf(n.Text)){var a="<span style='color:red;'>"+n.Text+"</span>";t.Text=i.replace(n.Text,a),s.Select2Data.push({Id:e.Id,Text:i.replace(n.Text,a)}),i=i.replace("<span style='color:red;'>",""),e.Text=i.replace("</span>","")}})},s.SetSelect2Values=function(e,t){$(".NT_side_footer").removeClass("unfixed"),e.isSelected=!e.isSelected;var i=s.Select2Data[t].Text;i=(i=(i=(i=i.replace("　","")).replace("　","")).replace("<span style='color:red;'>","")).replace("</span>",""),e.Text=i,e.Id=s.Select2Data[t].Id,n(function(){"Store"==s.tabId?(s.Select2Data01=s.Select2Data,s.SelectedList01=_.uniq(s.Select2List)):"Maintainer"==s.tabId?(s.Select2Data02=s.Select2Data,s.SelectedList02=s.Select2List):(s.Select2Data03=s.Select2Data,s.SelectedList03=s.Select2List)},300)};if(s.clearSelect2Values=function(){s.RequestTime={StartDate:null,EndDate:null},s.Emergency={Yes:!0,Normal:!0,DontCare:!1},s.RequisitionStatus={Filing:!1,Assignment:!0,InStore:!0,Acceptance:!1,Revocation:!1,OnConfirm:!1,OnProcess:!1,RawMaterialPending:!1},s.SearhParams={UnitIds:[],MaintainerIds:[],EquipmentIds:[],FuzzyCaseCode:null,RezConditions:[3],Emergency:[0,1,2],IsInspection:4,UnitRegionIds:[],UnitDivisionIds:[],EquipmentTypeClass:[0,1],EquipmentSubTypeId:[],Orders:s.OrderbyParames},s.Select2Data01=s.StoreList,s.Select2Data02=s.pcompanyList,s.Select2Data03=s.EquipmentList,s.StoreSelectedList=[],s.MaintainerSelectedList=[],s.EquipmentSelectedList=[],_.forEach(s.Select2List,function(e,t){e.Id="",e.Text=""}),_.forEach(s.Select2Data01,function(e){e.isSelected=!1}),_.forEach(s.SelectedList01,function(e){e.isSelected=!1}),_.forEach(s.SelectedList02,function(e){e.isSelected=!1}),_.forEach(s.SelectedList03,function(e){e.isSelected=!1}),s.Unit="",s.closeDenav("Multi"),s.SearchRepair(s.currentPage)},s.gotoSearch=function(){s.SearhParams.UnitIds=[],s.SearhParams.MaintainerIds=[],s.SearhParams.EquipmentIds=[];var e=[];_.forEach(s.StoreSelectedList,function(t){e.push(t.Text),_.forEach(s.StoreList,function(e){e.Id!=t.Id&&t.Id!=e.Level1&&t.Id!=e.Level2||s.SearhParams.UnitIds.push(e.Id)}),s.SearhParams.UnitIds.push(t.Id)}),s.Unit=e.toString(),_.forEach(s.MaintainerSelectedList,function(e){""!=e.Id&&null!=e.Id&&s.SearhParams.MaintainerIds.push(e.Id)}),_.forEach(s.EquipmentSelectedList,function(e){""!=e.Id&&null!=e.Id&&s.SearhParams.EquipmentIds.push(e.Id)}),s.closeDenav("Multi"),s.SearchRepair(s.currentPage)},s.clearSelect2GroupValues=function(){s.SearhParams.UnitRegionIds=[],s.SearhParams.Emergency=[0,1,2],s.SearhParams.EquipmentSubTypeId=[],s.SearhParams.IsInspection=4,s.GroupParames={Regions:[],Emergencys:[c.t("11074"),c.t("11075")],TypeName:[]},s.Emergency={Yes:!0,Normal:!0,DontCare:!1},console.log(s.Emergency),s.SubTypeSelected=[],_.forEach(s.inspectionType,function(e){e.Selected=!1}),s.closeDenav("Group"),s.GetCaseCount()},s.gotoGroupSearch=function(){s.closeDenav("Group"),s.GetCaseCount()},s.getNotifyList=function(){s.SearhParams.EquipmentTypeClass=[1],s.SearhParams.RezConditions=[2],s.SearhParams.IsInspection=4,s.SearchRepair(1),s.WPUIpage="listPage"},s.clearSelect2Values4Item=function(){_.forEach(s.Select2List,function(e,t){e.Id="",e.Text=""}),_.forEach(s.Select2Data,function(e){e.isSelected=!1}),"Store"==s.tabId?s.StoreList=s.Select2Data:"Maintainer"==s.tabId?s.pcompanyList=s.Select2Data:s.EquipmentList=s.Select2Data},s.loadSelect2Data4Item=function(){if("Store"==s.tabId){s.StoreSelectedList=_.uniq(s.SelectedList01),s.UnitIds=[];var e=[];_.forEach(s.StoreSelectedList,function(t){e.push(t.Text),_.forEach(s.Select2Data01,function(e){e.Id!=t.Id&&t.Id!=e.Level1&&t.Id!=e.Level2||s.UnitIds.push(e.Id)}),s.UnitIds.push(t.Id)}),s.GetProvider(),s.GetEquipment4Areas(),s.Unit=e.toString(),s.MaintainerSelectedList=[],s.EquipmentSelectedList=[]}else"Maintainer"==s.tabId?s.MaintainerSelectedList=s.SelectedList02:s.EquipmentSelectedList=s.SelectedList03},s.loadSearchParams=function(e){window.location.href="No"==e?"search_no.html":"search_muti.html"},s.$on("ReloadSearch",function(e,t){s.SearchRepair(s.currentPage)}),s.SearchRepair=function(e){s.isShowMore=!1,0<parseInt(e)?s.currentPage=e:s.currentPage=1,s.currentPage<=1&&(s.isLoading=!0),s.Search4No?(s.isLoading=!0,s.SearhParams.UnitIds=[],s.SearhParams.MaintainerIds=[],s.SearhParams.EquipmentIds=[]):(s.SearhParams.RequestTime=[],null!=s.RequestTime.StartDate&&s.SearhParams.RequestTime.push(s.RequestTime.StartDate),null!=s.RequestTime.EndDate&&s.SearhParams.RequestTime.push(s.RequestTime.EndDate));var t=s.SearhParams;"wxb04d43e40105795a"==s.AppId||"wxb39ebe28ba7036a5"==s.AppId?t=s.SearhParams:t.OpenId=s.OpenId,a({url:ApiMapper.sApi+"/s/rez/f/"+s.currentPage,method:"POST",contentType:"application/json",headers:{Passport:r.Passport},data:JSON.stringify(t)}).success(function(e){1==s.currentPage&&(s.RepairList=[]),console.log(e[2]),0<e[2]?(s.isShowDetail=!0,s.RepairCounts=parseInt(e[0]),s.isShowMore=1<s.RepairCounts,s.currentPage==s.RepairCounts?s.isShowMore=!1:s.isShowMore=!0,_.forEach(e[1],function(e){e.Selected=!1,e.swipeState=!1}),Array.prototype.push.apply(s.RepairList,e[1])):(s.isShowDetail=!1,s.isShowMore=!1),s.isLoading=!1}).error(function(){s.isLoading=!1})},s.LoadMore=function(){s.currentPage=s.currentPage+1,s.SearchRepair(s.currentPage),s.currentPage==s.RepairCounts&&(s.isShowMore=!1)},s.SetCaseCode=function(){s.SearhParams.UnitIds=[],s.SearhParams.MaintainerIds=[],s.SearhParams.EquipmentIds=[],n.cancel(p),n(function(){s.TimesForLock=0,s.Repair_Time("S")},100)},s.ForCallback=function(){n(function(){s.SearchRepair(s.currentPage)},200)},s.CloseSidenav=function(e){i(e).close().then(function(){})},s.GetDetail=function(e,t){window.localStorage.setItem("DetailId",e.RequisitionId),"Sign"==t?i("right_cancel_sign").toggle():(s.$broadcast("RepairList2Detail",e.RequisitionId),i("RepairDetail").toggle()),s.RepairInfo={},s.CheckedIds=[]},s.GetEquipmentpos=function(){if(null!=s.RepairInfo.IPositionIds){var t=s.RepairInfo.IPositionIds;""!=t&&a({url:ApiMapper.sApi+"/s/equipmentpos/"+s.RepairInfo.EquipmentId,method:"GET",contentType:"application/json",headers:{Passport:r.Passport},cache:!1}).success(function(e){s.Equipmentpos=_(e).filter(function(e){return 0<=t.indexOf(e.PositionId)})})}},s.getHistory=function(){a({url:ApiMapper.sApi+"/s/rez/history/"+s.RepairInfo.RequisitionId,method:"GET",contentType:"application/json",headers:{Passport:r.Passport}}).success(function(e){0<e.length&&(e=e.reverse(),s._TableData=e,_.forEach(s._TableData,function(e){e.ResponseTime=t("date")(new Date(e.ResponseTime),"yyyy/MM/dd HH:mm:ss")}),0<s._TableData.length&&(s.isTimeline=!0))})},s.GetUnitInfo=function(){a({url:ApiMapper.sApi+"/s/unit/"+Base64.encode(s.RepairInfo.UnitId),method:"GET",contentType:"application/json",headers:{Passport:r.Passport},cache:!1}).success(function(e){s.DeptInfo=e})},s.GetCheckinHistories=function(e){a({url:ApiMapper.sApi+"/s/checkin/"+e,method:"GET",contentType:"application/json",headers:{Passport:r.Passport}}).success(function(e){s.RepairInfo.CheckinHistories=[],_.forEach(e,function(e){e.Selected=!1}),s.RepairInfo.CheckinHistories=e})},s.M2H=function(e){var t=0;return t=(t=e/60)+"."+e%60*100/60,parseFloat(t).toFixed(2)},s.SetStore=function(e){i("Store").close().then(function(){""!=e&&(s.SearhParams={UnitIds:[],RequisitionStatus:s.SearhParams.RezConditions},s.Unit=e.Unit,s.SearhParams.UnitIds.push(e.UnitId),s.GetProvider(),s.GetAreas())})},s.SetMaintainer=function(e){i("Maintainer").close().then(function(){s.SearhParams={UnitIds:s.SearhParams.UnitIds,RequisitionStatus:s.SearhParams.RezConditions,MaintainerIds:[]},s.SearhParams.Orders=s.OrderbyParames,s.pcompanyName=e.MaintainerName,s.SearhParams.MaintainerIds.push(e.MaintainerId),s.SearchRepair(1)})},s.ECodeSearch=function(e){i("right-Area").close().then(function(){s.SearhParams={UnitIds:s.SearhParams.UnitIds,EquipmentIds:[],RequisitionStatus:s.SearhParams.RezConditions},s.SearhParams.Orders=s.OrderbyParames,s.EquipmentName=e.EquipmentName,s.SearhParams.EquipmentIds.push(e.EquipmentId),s.SearchRepair(1)})},s.exists=function(e,t){return-1<t.indexOf(e)},s.SetAreas=function(e){s.EquipmentName="",s.SearhParams.EquipmentIds=[];var t=s.AreasSelected.indexOf(e.PositionId);-1<t?(s.AreasSelected.splice(t,1),s.itemsAreaStr.splice(t,1)):(s.AreasSelected.push(e.PositionId),s.itemsAreaStr.push(e.Region+"-"+e.Position)),s.AreaStr=s.itemsAreaStr.toString(),s.SearhParams.positionIds=s.AreasSelected},s.Timeouter4Areas=function(){n.cancel(p),s.TimesForLock=0,s.Repair_Time("A")},s.SetCheckedIds=function(e){e.Selected=!e.Selected;var t=s.CheckedIds.indexOf(e.Id);-1<t?s.CheckedIds.splice(t,1):s.CheckedIds.push(e.Id)},s.SetRequisitions=function(e){var t=s.RequisitionIds.indexOf(e);-1<t?s.RequisitionIds.splice(t,1):s.RequisitionIds.push(e)},s.FormatDATE=FormatDate,s.toggleDenav=function(e){i(e).toggle()},s.closeDenav=function(e){s.swipeState=!1,i(e).close().then(function(){})},s.onHammer=function(e){s.eventType=e.type,"press"==e.type&&(s.longPressSta=!1,s.toggleDenavFN="")},s.change_openicon=function(){0==s.CollapseState?s.CollapseState=!0:s.CollapseState=!1},s.SelectSearch=function(e,t,i){switch(s.RepairList=[],s.RequisitionStatus={Filing:!1,Assignment:!1,Confirmed:!1,InStore:!1,Acceptance:!1,Revocation:!1,Overtime:!1,RawMaterialPending:!1},s.DivisionTempData={DivisionId:t,DivisionName:i},s.SearhParams.UnitDivisionIds=[t],s.SearhParams.RequestTime=[],e){case c.t("2002"):s.RequisitionStatus.InStore=!0,s.WPUIpage="listPage";break;case c.t("2003"):s.RequisitionStatus.Assignment=!0,s.WPUIpage="listPage";break;case c.t("2004"):s.RequisitionStatus.Filing=!0,s.WPUIpage="listPage";break;case c.t("2005"):s.RequisitionStatus.Confirmed=!0,s.WPUIpage="listPage";break;case c.t("2006"):s.RequestTime={StartDate:GetPreMonth(),EndDate:(new Date).Format()},s.RequisitionStatus.Acceptance=!0,s.WPUIpage="listPage";break;case c.t("2008"):s.RequestTime={StartDate:GetPreMonth(),EndDate:(new Date).Format()},s.RequisitionStatus.Revocation=!0,s.WPUIpage="listPage"}},s.GetCaseCount=function(){s.isLoading=!0;var e={UnitRegionIds:[],EquipmentTypeClass:[0,1],IsInspection:s.SearhParams.IsInspection};0<s.SearhParams.EquipmentTypeClass.length&&(e.EquipmentTypeClass=s.SearhParams.EquipmentTypeClass),0<s.SearhParams.UnitRegionIds.length&&(e.UnitRegionIds=s.SearhParams.UnitRegionIds),0<s.SearhParams.EquipmentSubTypeId.length&&(e.EquipmentSubTypeId=s.SearhParams.EquipmentSubTypeId),a({url:ApiMapper.sApi+"/s/rez/all/count/0",method:"POST",contentType:"application/json",headers:{Passport:r.Passport},data:e}).success(function(e){console.log(e),s.CaseCountList=e,"308ffed8-d4a7-4ad5-8b61-6cce3c66cd06"===r.CompanyId?_.forEach(s.CaseCountList,function(e){e.ImgUrl=r.CompanyId}):_.forEach(s.CaseCountList,function(e){e.ImgUrl=FormatLogoURI(e.DivisionId)}),s.isLoading=!1}).error(function(e){s.isLoading=!1})},s.ClassPage=function(){s.SearhParams.RezConditions=[],s.RequisitionStatus={Filing:!1,Assignment:!1,Confirmed:!1,InStore:!1,Acceptance:!1,Revocation:!1,Overtime:!1,RawMaterialPending:!1},s.RepairList=[],s.currentPage=1,s.WPUIpage="selectPage",s.GetCaseCount()},s.callback2case=function(){s.WPUIpage="selectPage",s.ClassPage()},"308ffed8-d4a7-4ad5-8b61-6cce3c66cd06"!==r.CompanyId)s.IsUItoWP=!0,s.SearhParams.RezConditions=[],s.RequisitionStatus={Filing:!1,Assignment:!1,Confirmed:!1,InStore:!1,Acceptance:!1,Revocation:!1,Overtime:!1,RawMaterialPending:!1},s.RepairList=[],s.currentPage=1,s.isLoading=!0,s.GetCaseCount(),s.getRegions(),s.getFacility(),s.getInspectionType();else{var d=getParameterByName("selectClass");if(d){switch(s.isLoading=!0,d){case"Arrived":d=c.t("2002");break;case"Dispatched":d=c.t("2003");break;case"Registered":d=c.t("2004");break;case"Confirmed":d=c.t("2005");break;case"Acceptance":d=c.t("2006");break;case"Revocation":d=c.t("2008")}s.SelectSearch(d,null,null)}}}]);
//# sourceMappingURL=Search.js.map
